<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICT විද්‍යාගාරය: දත්ත සැකසුම් අත්හදා බැලීම</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+Sinhala:wght=400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans Sinhala', 'Inter', sans-serif;
            background-color: #F8FAFC;
            color: #1F2937;
        }
        h1, h2, h3 {
            color: #1E40AF; /* Primary Blue */
            font-weight: 700;
        }
        .card {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            border-top: 5px solid #3B82F6;
        }
        .toggle-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.2s;
            cursor: pointer;
            width: 100%;
            text-align: center;
        }
        .on { background-color: #10B981; color: white; box-shadow: 0 4px #059669; }
        .off { background-color: #FEE2E2; color: #DC2626; border: 1px solid #DC2626; }
        .on:active { transform: translateY(1px); box-shadow: none; }
        .off:active { transform: translateY(1px); }
        .input-group label { display: block; margin-bottom: 0.25rem; font-weight: 500; }
        .input-group input { width: 100%; padding: 0.5rem; border: 1px solid #D1D5DB; border-radius: 6px; }
        
        .result-cell {
            padding: 0.5rem;
            font-weight: 600;
            border-radius: 4px;
        }
        .pass { background-color: #D1FAE5; color: #065F46; }
        .fail { background-color: #FEE2E2; color: #991B1B; }
        .loading { animation: pulse 1s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>

<header class="bg-white shadow-lg">
    <div class="container mx-auto px-4 py-8 text-center">
        <h1 class="text-4xl md:text-5xl font-extrabold text-blue-700">
            දත්ත සැකසුම් විද්‍යාගාරය (ICT Processing Lab)
        </h1>
        <p class="text-lg mt-2 text-gray-600">
            <span class="font-bold">Experiment:</span> Data-to-Information Transformation by Tuning Parameters.
        </p>
    </div>
</header>

<main class="container mx-auto p-4 md:p-8 grid grid-cols-1 lg:grid-cols-3 gap-8">

    <!-- Column 1: Raw Data Input (දත්ත ආදානය) -->
    <section class="card lg:col-span-1 border-t-8 border-blue-600">
        <h2 class="text-2xl mb-4 border-b pb-2">1. Raw Data Input (අමු දත්ත)</h2>
        <p class="text-sm text-gray-600 mb-4">
            <span class="font-bold text-blue-600">Definition:</span> Raw Facts or Figures (දත්ත). Enter student names and their raw scores.
        </p>
        <div id="data-inputs" class="space-y-3 max-h-96 overflow-y-auto">
            <!-- Initial input rows generated by JS -->
        </div>
        <button onclick="addRow()" class="mt-4 w-full bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-2 rounded-lg transition duration-150">
            Add Row (දත්ත පේළියක් එක් කරන්න)
        </button>
    </section>

    <!-- Column 2: Tuning & Toggling (සැකසුම් නීති) -->
    <section class="card lg:col-span-1 border-t-8 border-green-600">
        <h2 class="text-2xl mb-4 border-b pb-2">2. Processing Rules (Tuning)</h2>
        <p class="text-sm text-gray-600 mb-6">
            <span class="font-bold text-green-600">Concept:</span> Data Processing (දත්ත සැකසීම). Toggle rules to convert data into meaningful information.
        </p>

        <!-- Rule 1: Filtering (Relevance) -->
        <div class="mb-6 p-4 rounded-lg bg-gray-50 border">
            <h3 class="text-xl mb-3 font-bold text-gray-800">Rule A: Filtering (අදාළත්වය)</h3>
            <div class="input-group mb-3">
                <label for="minScore" class="text-sm">Minimum Pass Score (අවම ලකුණු):</label>
                <input type="number" id="minScore" value="50" min="1" max="100" class="w-full text-center">
            </div>
            <button id="toggleFilter" class="toggle-btn off" onclick="toggleProcessing('filter')">
                Filter OFF (පෙරහන් කිරීම අක්‍රියයි)
            </button>
        </div>

        <!-- Rule 2: Calculation (Accuracy/Completeness) -->
        <div class="mb-6 p-4 rounded-lg bg-gray-50 border">
            <h3 class="text-xl mb-3 font-bold text-gray-800">Rule B: Grading (සම්පූර්ණත්වය)</h3>
            <button id="toggleGrade" class="toggle-btn off" onclick="toggleProcessing('grade')">
                Grading OFF (ශ්‍රේණිගත කිරීම අක්‍රියයි)
            </button>
        </div>

        <!-- Rule 3: Cloud Acceleration (Cloud Computing) -->
        <div class="p-4 rounded-lg bg-yellow-50 border-2 border-yellow-500">
            <h3 class="text-xl mb-3 font-bold text-gray-800">System Tuning: Cloud Acceleration</h3>
            <p class="text-xs text-gray-600 mb-3">
                <span class="font-bold text-yellow-700">Concept:</span> Cloud Computing (වළාකුළු පරිගණක). Toggle Cloud to reduce processing time (Timeliness).
            </p>
            <button id="toggleCloud" class="toggle-btn off" onclick="toggleProcessing('cloud')">
                Cloud OFF (මන්දගාමී සැකසීම)
            </button>
        </div>

        <button onclick="processData()" class="mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-extrabold py-3 rounded-lg text-lg transition duration-150">
            Run Processing (සැකසීම ආරම්භ කරන්න)
        </button>
    </section>

    <!-- Column 3: Information Output & Quality Report -->
    <section class="card lg:col-span-1 border-t-8 border-red-600">
        <h2 class="text-2xl mb-4 border-b pb-2">3. Information Output & Quality</h2>
        <p class="text-sm text-gray-600 mb-4">
            <span class="font-bold text-red-600">Concepts:</span> Information (තොරතුරු) & Characteristics (ගතිලක්ෂණ).
        </p>

        <!-- Output Table -->
        <div class="mb-6">
            <h3 class="text-xl font-bold text-gray-800 mb-2">Processed Results (සැකසූ ප්‍රතිඵල)</h3>
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Name (නම)</th>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Score (ලකුණු)</th>
                        <th class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status (තත්ත්වය)</th>
                    </tr>
                </thead>
                <tbody id="result-output" class="bg-white divide-y divide-gray-200 text-sm">
                    <tr><td colspan="3" class="px-3 py-4 text-gray-400">Run processing to see results...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- Quality Report -->
        <div class="p-4 rounded-lg bg-teal-50 border-2 border-teal-500">
            <h3 class="text-xl font-bold text-gray-800 mb-2">Information Quality Report (තොරතුරු ගුණාත්මකභාවය)</h3>
            <p id="quality-report" class="text-gray-700 font-semibold text-lg">Quality Score: 0/3</p>
            <p class="text-xs mt-2 text-gray-600">
                <span class="font-bold">Score Breakdown:</span> 
                Filter On = Relevance (+1), Grade On = Completeness (+1), Cloud On = Timeliness (+1).
            </p>
        </div>

    </section>

</main>

<footer class="text-center p-6 mt-8">
    <p class="text-gray-600 text-sm">
        ICT Lab Activity. සිසුන් සඳහා අන්තර්ක්‍රියාකාරී ඉගෙනුම් අත්දැකීමකි.
    </p>
</footer>

<script>
    const state = {
        isFilterOn: false,
        isGradeOn: false,
        isCloudOn: false,
        minScore: 50,
        dataCount: 3, // Initial data rows
    };

    // --- Core UI Functions ---

    function createRowHtml(index, name = '', score = '') {
        return `
            <div id="row-${index}" class="flex space-x-2 items-center">
                <input type="text" id="name-${index}" value="${name}" placeholder="Name (නම)" class="flex-1 px-2 py-1 border rounded text-sm focus:ring-blue-500 focus:border-blue-500">
                <input type="number" id="score-${index}" value="${score}" placeholder="Score (ලකුණු)" min="0" max="100" class="w-20 px-2 py-1 border rounded text-sm text-center focus:ring-blue-500 focus:border-blue-500">
                <button onclick="removeRow(${index})" class="text-red-500 hover:text-red-700 text-lg font-bold p-1 leading-none">
                    &times;
                </button>
            </div>
        `;
    }

    function addRow(name = '', score = '') {
        const index = state.dataCount++;
        document.getElementById('data-inputs').insertAdjacentHTML('beforeend', createRowHtml(index, name, score));
    }

    function removeRow(index) {
        document.getElementById(`row-${index}`).remove();
    }
    
    // Initialize with 3 rows of sample data
    window.onload = function() {
        addRow('Student A', 75);
        addRow('Student B', 45);
        addRow('Student C', 88);

        document.getElementById('minScore').addEventListener('input', (e) => {
            state.minScore = parseInt(e.target.value) || 0;
            if (state.minScore < 0) state.minScore = 0;
            if (state.minScore > 100) state.minScore = 100;
        });
    };

    // --- Toggling Logic (Tuning) ---
    
    function toggleProcessing(type) {
        const btn = document.getElementById(`toggle${type.charAt(0).toUpperCase() + type.slice(1)}`);
        
        if (type === 'filter') {
            state.isFilterOn = !state.isFilterOn;
            btn.className = state.isFilterOn ? 'toggle-btn on' : 'toggle-btn off';
            btn.textContent = state.isFilterOn ? `Filter ON (Min: ${state.minScore})` : 'Filter OFF (පෙරහන් කිරීම අක්‍රියයි)';
        } else if (type === 'grade') {
            state.isGradeOn = !state.isGradeOn;
            btn.className = state.isGradeOn ? 'toggle-btn on' : 'toggle-btn off';
            btn.textContent = state.isGradeOn ? 'Grading ON (ශ්‍රේණිගත කිරීම සක්‍රියයි)' : 'Grading OFF (ශ්‍රේණිගත කිරීම අක්‍රියයි)';
        } else if (type === 'cloud') {
            state.isCloudOn = !state.isCloudOn;
            btn.className = state.isCloudOn ? 'toggle-btn on bg-yellow-600 box-shadow-yellow' : 'toggle-btn off';
            btn.textContent = state.isCloudOn ? 'Cloud ON (වේගවත් සැකසීම)' : 'Cloud OFF (මන්දගාමී සැකසීම)';
        }
    }

    // --- Main Processing Logic ---

    function getRawData() {
        const rawData = [];
        const inputContainer = document.getElementById('data-inputs');
        inputContainer.querySelectorAll('[id^="name-"]').forEach(nameInput => {
            const index = nameInput.id.split('-')[1];
            const scoreInput = document.getElementById(`score-${index}`);
            
            if (nameInput.value.trim() && scoreInput.value.trim()) {
                rawData.push({
                    name: nameInput.value.trim(),
                    score: parseInt(scoreInput.value.trim()) || 0
                });
            }
        });
        return rawData;
    }

    function updateQualityReport(score) {
        const reportElement = document.getElementById('quality-report');
        reportElement.textContent = `Quality Score: ${score}/3`;
        if (score === 3) {
            reportElement.className = 'text-green-700 font-extrabold text-xl';
        } else if (score >= 1) {
             reportElement.className = 'text-orange-700 font-bold text-lg';
        } else {
            reportElement.className = 'text-red-700 font-bold text-lg';
        }
    }

    async function processData() {
        const rawData = getRawData();
        const outputElement = document.getElementById('result-output');
        
        // 1. Simulate Processing Time (Timeliness/Cloud Concept)
        let delay = state.isCloudOn ? 200 : 2000; // Cloud: 200ms, Local: 2000ms
        
        outputElement.innerHTML = `<tr><td colspan="3" class="px-3 py-4 text-center text-gray-400 loading">Processing... (${delay}ms)</td></tr>`;
        
        // Disable Run button
        const runButton = document.querySelector('button[onclick="processData()"]');
        runButton.disabled = true;
        runButton.textContent = 'Processing...';

        await new Promise(resolve => setTimeout(resolve, delay));
        
        // 2. Perform Processing
        let processedData = [];
        let qualityScore = 0;

        // Tally Quality Score
        if (state.isFilterOn) qualityScore++; // Relevance
        if (state.isGradeOn) qualityScore++;   // Completeness/Accuracy
        if (state.isCloudOn) qualityScore++;  // Timeliness (Fast Processing)
        
        updateQualityReport(qualityScore);

        rawData.forEach(item => {
            let status = '---';

            // Rule B: Grading (Tuning)
            if (state.isGradeOn) {
                if (item.score >= state.minScore) {
                    status = 'PASS (සමත්විය)';
                } else {
                    status = 'FAIL (අසමත්විය)';
                }
            } else {
                status = 'RAW SCORE (අමු ලකුණු)';
            }
            
            // Rule A: Filtering (Tuning)
            const isFilteredOut = state.isFilterOn && item.score < state.minScore;

            if (!isFilteredOut) {
                processedData.push({
                    name: item.name,
                    score: item.score,
                    status: status,
                    isPass: item.score >= state.minScore && state.isGradeOn // For styling
                });
            }
        });

        // 3. Output Generation (Information Concept)
        let outputHtml = '';
        if (processedData.length === 0) {
            outputHtml = `<tr><td colspan="3" class="px-3 py-4 text-center text-gray-400">No results found or all filtered out.</td></tr>`;
        } else {
            processedData.forEach(p => {
                const statusClass = p.status.includes('PASS') ? 'pass' : (p.status.includes('FAIL') ? 'fail' : 'bg-gray-100 text-gray-700');
                outputHtml += `
                    <tr>
                        <td class="px-3 py-2 whitespace-nowrap text-gray-800">${p.name}</td>
                        <td class="px-3 py-2 whitespace-nowrap text-center">${p.score}</td>
                        <td class="px-3 py-2 whitespace-nowrap">
                            <span class="result-cell ${statusClass}">${p.status}</span>
                        </td>
                    </tr>
                `;
            });
        }

        outputElement.innerHTML = outputHtml;
        runButton.disabled = false;
        runButton.textContent = 'Run Processing (සැකසීම ආරම්භ කරන්න)';
    }

</script>
</body>
</html>
